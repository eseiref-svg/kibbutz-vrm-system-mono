# 🔧 הוראות לתיקון הבעיה

## הבעיה
השרת מחזיר הודעה ישנה: "שדות חובה: שם לקוח, שם איש קשר, טלפון, סכום, תנאי תשלום"

**הסיבה:** השרת לא נטען מחדש עם הקוד המעודכן.

## ✅ מה שבוצע בהצלחה

1. ✅ הקוד ב-`server.js` מעודכן נכון - לא דורש שדות עסקה
2. ✅ הטופס ב-`ClientRequestForm.js` נכון - רק פרטי לקוח
3. ✅ כל ה-migrations בוצעו במסד הנתונים
4. ✅ בדיקות DB ישירות עברו בהצלחה

## 🔧 פתרון

### שלב 1: עצור את השרת
1. פתח את חלון השרת (PowerShell שבו השרת רץ)
2. לחץ `Ctrl+C` כדי לעצור את השרת

### שלב 2: ודא שאין עוד תהליכים
```powershell
# בדוק אם יש עוד תהליכי Node.js שרצים על פורט 5000
Get-NetTCPConnection -LocalPort 5000 -ErrorAction SilentlyContinue

# אם יש, עצור אותם:
Get-NetTCPConnection -LocalPort 5000 -ErrorAction SilentlyContinue | 
  ForEach-Object { Stop-Process -Id $_.OwningProcess -Force }
```

### שלב 3: הפעל מחדש את השרת
```powershell
cd naan-vrm-server
npm start
```

### שלב 4: בדוק שהכל עובד
לאחר שהשרת רץ, נסה שוב:
1. התחבר כמנהל ענף: `manager@test.com / 111222333`
2. לחץ על "בקשה ללקוח חדש"
3. מלא את הטופס (רק פרטי לקוח)
4. שלח את הבקשה

## 📋 מה אמור לקרות

✅ הטופס מכיל רק:
- שם הלקוח *
- שם איש קשר *
- טלפון איש קשר *
- אימייל איש קשר
- עיר, רחוב, מספר בית, מיקוד

❌ הטופס **לא** מכיל:
- סכום
- תנאי תשלום
- תאריך תשלום

✅ השרת אמור לקבל רק פרטי לקוח ולחזור עם `request_id` ו-`status: pending`

## 🧪 בדיקה

לאחר הפעלת השרת מחדש, הרץ:
```bash
node test-e2e-flow.js
```

או בדוק בדפדפן שהטופס עובד.


